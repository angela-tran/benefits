{% load i18n %}
{% if form.action_url %}

  {% url form.action_url as form_action %}

  <form id="{{ form.id }}" action="{{ form_action }}" method="{{ form.method | default:"post" | upper }}" role="form">
    {% csrf_token %}

    <div class="row form-container">
      <div class="{{ form.classes }}">
        {% for field in form %}
          <div class="row form-group mb-0">
            <div class="col-12">
              {% if field.label %}
                <label for="{{ field.id_for_label }}" class="form-control-label">
                  {{ field.label }}
                  {% if field.field.required %}<span class="required-label text-body">*</span>{% endif %}
                </label>
              {% endif %}

              {{ field }}

              {% if field.help_text %}<small class="form-text text-body">{{ field.help_text }}</small>{% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    </div>

    {% if form.submit_value %}
      <div class="row d-flex flex-column-reverse justify-content-lg-end flex-lg-row pt-8">
        {% if help_text %}
          <div class="col-lg-9 d-flex align-items-end flex-row-reverse col-sm-8 offset-sm-2 offset-lg-0 offset-2 col-8">
            <p class="pt-4 pt-lg-0">{{ help_text }}</p>
          </div>
        {% endif %}
        <div class="col-lg-3 offset-2 offset-sm-2 offset-lg-0 col-sm-8 col-8">
          <button class="btn btn-lg btn-primary" form="{{ form.id }}" data-action="submit" type="submit">
              {{ form.submit_value }}
            </button>
        </div>
      </div>
    {% endif %}

    {% if form.recaptcha_enabled %}
      <script>
        function onSubmit(token) {
          $("#{{ form.id }}").submit();
        }
      </script>
    {% endif %}

    <script>
      $(function(){
        $("#{{ form.id }}").on("submit", function(e) {
          if ("{{ form.submitting_value }}" !== "") {
            $("button[type=submit]", this)
              .attr("role", "status")
              .attr("disabled", "true")
              .text("{{ form.submitting_value }}")
              .addClass("disabled");
          }
        });
      });
    </script>
  </form>

{% endif %}
